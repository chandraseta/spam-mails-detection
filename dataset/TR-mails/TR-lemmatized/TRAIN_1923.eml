deadlock problem hi xfs developers study xfs code find inode lock xfs_ilock_share flag get acl may deadlock get acl allocate memory km_sleep memory tight process call xfs_strategy may lock xfs_ilock_share inode two lock another process try lock inode xfs_ilock_excl two process deadlock follow process get ea b process want lock ipa xfs_ilock ipa xfs_ilock_share get acl xfs_ilock ipa xfs_ilock_excl memory tight xfs_stragegy xfs_ilock ipa xfs_ilock_share two process dead lock believe acl allocation gfp_maskshould change km_nofs right best regard wdd